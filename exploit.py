from pwn import *
from dbg import *

binary_path = "./chall"
context.log_level = "info"
context.binary = lbin = ELF(binary_path)

ctx = pwnio(lbin,
            use_remote=False,
            use_debugger=True,
            debugger="r2",
            remote_ip="",
            remote_port=-1,
            libc=None,
            ld=None)

context.terminal = ctx.terminal = ["alacritty", "-e"]

io = ctx.connect()

maps = io.libs()
pb = maps[lbin.path]

print("Process Maps:")
for name in maps.keys():
    print(f"{name}: {hex(maps[name])}")

gdb_script = f"""
"""
# radare2 script
r2_script = f"""
aaa
"""

ctx.debug(r2_script=r2_script)

io.interactive()